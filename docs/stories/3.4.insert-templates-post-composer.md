# Story 3.4: Insert Templates into Post Composer

## Status

Draft

## Story

**As a** content creator,
**I want** to insert saved templates into the post creation form,
**so that** I can quickly reuse common content blocks.

## Acceptance Criteria

1. The post composer displays an "Insert Template" button/icon next to the text input fields.
2. Clicking "Insert Template" opens a modal showing the user's template library with search and tag filters.
3. Templates in the modal display name, content preview, and tags.
4. Clicking a template inserts its content at the cursor position in the active text field (Twitter or LinkedIn).
5. After insertion, the modal closes and the `lastUsedAt` and `usageCount` fields are updated for the template.
6. If no cursor position is available, content is appended to the end of the text field.
7. Template insertion works correctly for both Twitter and LinkedIn text fields independently.

## Tasks / Subtasks

- [ ] **Task 1: Add "Insert Template" button to post composer** (AC: 1)
- [ ] **Task 2: Create template picker modal component** (AC: 2, 3)
- [ ] **Task 3: Integrate search/filter from Story 3.3** (AC: 2)
- [ ] **Task 4: Implement cursor position detection** (AC: 4, 6)
- [ ] **Task 5: Implement content insertion logic** (AC: 4, 7)
- [ ] **Task 6: Update template usage metrics** (AC: 5)
- [ ] **Task 7: Handle Twitter vs LinkedIn field context** (AC: 7)
- [ ] **Task 8: Write integration tests** (AC: 1-7)

## Dev Notes

### Architecture Context

This story integrates the template library (Epic 3) with the post creation workflow (Epic 2).

**Key Design Decisions:**
- Template picker reuses search/filter components from Story 3.3
- Cursor position preserved during insertion
- Usage tracking happens automatically on insertion

### Component Specifications

**Files to Modify:**
- `components/features/PostScheduler.tsx` - Add Insert Template button
- `components/features/TemplatePickerModal.tsx` - New modal for template selection

**Files to Update:**
- `convex/templates.ts` - Add updateTemplateUsage mutation

## Testing

Integration tests for template insertion in both Twitter and LinkedIn fields.

## Change Log

| Date       | Version | Description                          | Author     |
| :--------- | :------ | :----------------------------------- | :--------- |
| 2025-11-01 | 1.0     | Initial draft created from Epic 3.4. | Sarah (PO) |

## Dev Agent Record

To be populated by Dev Agent during implementation.

## QA Results

To be populated by QA Agent after implementation review.
