# Story 5.1: Dual Text Field UI Architecture

## Status

Done

## Story

**As a** content creator,
**I want** separate, visually distinct text fields for Twitter and LinkedIn content,
**so that** I can clearly see and edit platform-specific content without confusion.

## Acceptance Criteria

1. The post creation form displays two clearly labeled text areas: "Twitter/X Content" and "LinkedIn Content".
2. Each text area is visually distinct with platform branding (colors, icons).
3. Text areas are vertically stacked on mobile and can be displayed side-by-side on larger screens.
4. Each text area has independent focus state and cursor management.
5. Users can expand/collapse either text area to maximize editing space.
6. A toggle switch allows users to enable/disable posting to each platform independently.
7. When a platform is disabled, its text area is visually dimmed but content is preserved.

## Tasks / Subtasks

- [x] **Task 1: Create dual text field component structure** (AC: 1, 3, 4)
  - [x] Create new component `DualPlatformTextFields.tsx` in `components/features/`
  - [x] Define component props: `twitterContent`, `linkedInContent`, `onTwitterChange`, `onLinkedInChange`, `twitterEnabled`, `linkedInEnabled`
  - [x] Implement two separate textarea elements with proper labels and IDs
  - [x] Add responsive layout using Tailwind CSS: vertically stacked on mobile, side-by-side on larger screens (lg: breakpoint)
  - [x] Ensure each textarea has independent focus state management
  - [x] Add proper accessibility attributes (aria-labels, roles)

- [x] **Task 2: Implement platform branding and visual distinction** (AC: 2)
  - [x] Add Twitter/X brand colors (e.g., border, icon) to Twitter text area
  - [x] Add LinkedIn brand colors (e.g., border, icon) to LinkedIn text area
  - [x] Import or create platform icons (Twitter/X logo, LinkedIn logo)
  - [x] Position icons prominently near the text area labels
  - [x] Apply distinct styling to each text area container for visual separation

- [x] **Task 3: Implement expand/collapse functionality** (AC: 5)
  - [x] Add expand/collapse button/icon to each text area header
  - [x] Create local state to track expanded/collapsed state for each text area
  - [x] Implement CSS transitions for smooth expand/collapse animation
  - [x] When one text area is expanded, optionally minimize the other for focus
  - [x] Ensure expanded state is maintained during editing (doesn't auto-collapse)

- [x] **Task 4: Implement platform toggle switches** (AC: 6, 7)
  - [x] Add toggle switch UI elements above or beside each text area using shadcn/ui Switch component
  - [x] Connect toggle state to `twitterEnabled` and `linkedInEnabled` props
  - [x] Implement `onTwitterEnabledChange` and `onLinkedInEnabledChange` callback props
  - [x] Apply visual dimming (reduced opacity, disabled styling) to text area when platform is disabled
  - [x] Ensure content is preserved in state even when platform is disabled
  - [x] Prevent form submission if both platforms are disabled (add validation)

- [x] **Task 5: Integrate DualPlatformTextFields into existing post creation form** (AC: 1-7)
  - [x] Locate existing post creation form component (likely `PostScheduler.tsx` or similar in `components/features/`)
  - [x] Replace or refactor existing single text field with new `DualPlatformTextFields` component
  - [x] Update form state management to handle separate `twitterContent` and `linkedInContent`
  - [x] Update form state to track `twitterEnabled` and `linkedInEnabled` boolean flags
  - [x] Ensure form validation accounts for enabled/disabled platforms
  - [x] Test integration with existing character counters and scheduling logic

- [x] **Task 6: Add unit tests for DualPlatformTextFields component** (AC: 1-7)
  - [x] Create test file `components/features/DualPlatformTextFields.test.tsx`
  - [x] Test: Component renders with correct labels for both platforms
  - [x] Test: Platform branding (colors/icons) is applied correctly
  - [x] Test: Responsive layout changes based on screen size (if feasible with testing library)
  - [x] Test: Independent focus state for each textarea
  - [x] Test: Expand/collapse functionality works correctly
  - [x] Test: Toggle switches enable/disable platforms and apply visual dimming
  - [x] Test: Content is preserved when platform is disabled
  - [x] Test: onChange callbacks are called with correct values

## Dev Notes

### Previous Story Context

Story 4.5 completed the Queue Conflict Detection & Resolution feature, which was the final story in Epic 4 (Content Recycling & Re-queue System). Epic 5 focuses on enhancing the dual-platform content workflow with improved UI architecture and user experience.

### Frontend Architecture

[Source: docs/architecture/frontend-architecture.md#Component Architecture]

- **Component Location**: Create new component in `components/features/` directory for complex feature components
- **UI Primitives**: Use shadcn/ui components from `components/ui/` for basic UI elements (buttons, switches, etc.)
- **State Management**: Use React `useState` hooks for local UI state (expand/collapse state, platform toggles, text content)
- **Convex Integration**: The parent form component will handle Convex mutations; this component focuses on UI presentation and local state

[Source: docs/architecture/frontend-architecture.md#State Management Architecture]

- **Local UI State**: Standard React hooks (`useState`) manage temporary UI state like form inputs, modal visibility, and tab selection
- **Global State (Data)**: Primary state driven by Convex via `useQuery` hooks (not directly used in this component, but in parent form)

### Tech Stack

[Source: docs/architecture/tech-stack.md]

- **Frontend Framework**: Next.js 15.5.4 (App Router), React 19
- **UI Component Library**: shadcn/ui - Use for Switch component (toggle), Button component, and other UI primitives
- **Styling**: Tailwind CSS 4 - Use utility classes for responsive layout, platform branding colors, and visual states
- **Language**: TypeScript - Ensure all props and state are properly typed

### Component Design Patterns

**Responsive Layout Pattern**:

- Use Tailwind CSS responsive breakpoints: `flex flex-col lg:flex-row` for vertical stacking on mobile, side-by-side on larger screens
- Mobile: `flex-col` (vertical stack)
- Desktop: `lg:flex-row` (side-by-side)

**Platform Branding Colors** (suggested):

- Twitter/X: Blue accent (`#1DA1F2` or similar) for border/icon
- LinkedIn: Blue accent (`#0A66C2`) for border/icon
- Use Tailwind's arbitrary color values: `border-[#1DA1F2]` or define custom colors in Tailwind config

**Visual Dimming Pattern**:

- When platform is disabled: Apply `opacity-50` and `cursor-not-allowed` classes to text area
- Ensure the textarea is not actually disabled (so content remains accessible for reading/editing when re-enabled)

**Independent Focus State**:

- Each textarea should have its own focus styling without interfering with the other
- Use standard browser focus behavior, enhanced with Tailwind focus utilities: `focus:ring-2 focus:ring-blue-500`

### Data Models

[Source: docs/architecture/data-models.md]

The `posts` table has separate fields for Twitter and LinkedIn content:

- `twitterContent`: string (stores Twitter post text)
- `linkedInContent`: string (stores LinkedIn post text)
- `twitterScheduledTime`: number (timestamp)
- `linkedInScheduledTime`: number (timestamp)

This component will update these fields independently based on which text area the user is editing.

### File Structure

Based on frontend architecture, create:

- `components/features/DualPlatformTextFields.tsx` - Main component
- `components/features/DualPlatformTextFields.test.tsx` - Test file (if testing is implemented)

The component will be imported and used in the existing post creation form, likely located at:

- `app/schedule/page.tsx` (route) or
- `components/features/PostScheduler.tsx` (feature component)

### Testing

[Source: docs/architecture/testing-strategy.md#Unit Testing]

- **Test Level**: Unit tests for React component
- **Tools**: Jest (or equivalent React testing library)
- **Testing Focus**:
  - Component rendering with correct props
  - User interactions (typing, toggling, expanding/collapsing)
  - Visual state changes (dimming, focus)
  - Callback invocation with correct parameters

**Testing Requirements**:

- Test file location: `components/features/DualPlatformTextFields.test.tsx`
- Test frameworks: Jest with React Testing Library
- Test independent focus state for each textarea
- Test responsive layout behavior (if feasible)
- Test expand/collapse state management
- Test platform toggle functionality and visual feedback

### Accessibility Considerations

- Add `aria-label` attributes to textareas for screen readers
- Add `aria-expanded` attribute to expand/collapse buttons
- Ensure toggle switches are keyboard accessible
- Maintain proper focus order when tabbing through form elements
- Ensure sufficient color contrast for platform branding colors

### Implementation Notes

1. **Character Limits**: This story focuses on UI architecture. Character counting/validation will be implemented in Story 5.3. However, the textareas should be ready to display character counts in future stories.

2. **Content Pre-population**: This story creates the separate text fields. Smart content pre-population from Twitter to LinkedIn will be implemented in Story 5.2.

3. **Existing Form Integration**: The existing post creation form (from Story 2.3 "Dual Platform Post Creation Form") likely already has some dual-platform logic. This story refactors and enhances that UI with clearer visual separation and expand/collapse functionality.

4. **Platform Icons**: Consider using a library like `react-icons` or `lucide-react` (commonly paired with shadcn/ui) for Twitter and LinkedIn icons, or use SVG icons directly.

## Change Log

| Date       | Version | Description                 | Author       |
| :--------- | :------ | :-------------------------- | :----------- |
| 2025-11-03 | 1.0     | Initial story draft created | Scrum Master |

## Dev Agent Record

### Agent Model Used

claude-sonnet-4-5-20250929

### Debug Log References

None

### Completion Notes

- Successfully created DualPlatformTextFields component with all required features
- Component includes platform branding with Twitter (#1DA1F2) and LinkedIn (#0A66C2) colors
- Platform icons implemented using @tabler/icons-react (IconBrandX, IconBrandLinkedin)
- Toggle switches use shadcn/ui Switch component
- Expand/collapse functionality implemented with smooth transitions
- Visual dimming applied when platforms are disabled (opacity-60)
- Content preservation ensured when toggling platforms on/off
- Independent focus state management for each textarea
- Character counting with warning and error states integrated
- Added Switch component to UI library via shadcn CLI
- Refactored PostScheduler component to use new DualPlatformTextFields
- Removed unused platform selection checkboxes from PostScheduler
- All 33 unit tests passing for DualPlatformTextFields component
- Comprehensive test coverage including accessibility, user interactions, and edge cases
- ESLint passing with no warnings
- TypeScript compilation successful (pre-existing test errors unrelated to this story)

### File List

**Created:**

- components/features/DualPlatformTextFields.tsx
- components/features/**tests**/DualPlatformTextFields.test.tsx
- components/ui/switch.tsx (added via shadcn CLI)

**Modified:**

- components/features/PostScheduler.tsx (refactored to use DualPlatformTextFields)

## QA Results

_To be populated by QA agent_
