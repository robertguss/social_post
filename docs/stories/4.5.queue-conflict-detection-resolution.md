# Story 4.5: Queue Conflict Detection & Resolution

## Status

Draft

## Story

**As a** content creator,
**I want** the system to detect and warn me about scheduling conflicts,
**so that** I don't accidentally post duplicate content at the same time.

## Acceptance Criteria

1. When creating a recurring queue, the system checks for existing queues with the same original post ID.
2. If a duplicate queue exists (active or paused), a warning message displays: "A queue for this post already exists."
3. The warning includes options: "View Existing Queue", "Create Anyway", or "Cancel".
4. When a queue's next scheduled time conflicts with an already scheduled post (within 1 hour window), a conflict notification is displayed in the Queues page.
5. Users can manually adjust the queue's next scheduled time to resolve conflicts.
6. The system prevents scheduling if the conflict is exact (same post, same platform, same exact time).
7. Conflict detection works across both manually scheduled posts and queue-generated posts.

## Tasks / Subtasks

- [ ] **Task 1: Implement duplicate queue detection** (AC: 1, 2)
- [ ] **Task 2: Create warning modal with options** (AC: 2, 3)
- [ ] **Task 3: Implement conflict detection logic** (AC: 4, 7)
- [ ] **Task 4: Display conflict notifications on Queues page** (AC: 4)
- [ ] **Task 5: Add manual time adjustment UI** (AC: 5)
- [ ] **Task 6: Prevent exact duplicate scheduling** (AC: 6)
- [ ] **Task 7: Write tests for conflict detection** (AC: 1-7)

## Dev Notes

### Architecture Context

Final story in Epic 4, adds conflict prevention to ensure queue reliability.

### Technical Constraints

**Conflict Detection Rules:**
- Duplicate queue: Same originalPostId, status active or paused
- Time conflict: Within 1 hour window (Â±30 minutes)
- Exact conflict: Same post, same platform, same exact timestamp

## Testing

Tests for duplicate detection, time conflicts, and conflict resolution.

## Change Log

| Date       | Version | Description                          | Author     |
| :--------- | :------ | :----------------------------------- | :--------- |
| 2025-11-01 | 1.0     | Initial draft created from Epic 4.5. | Sarah (PO) |

## Dev Agent Record

To be populated by Dev Agent during implementation.

## QA Results

To be populated by QA Agent after implementation review.
